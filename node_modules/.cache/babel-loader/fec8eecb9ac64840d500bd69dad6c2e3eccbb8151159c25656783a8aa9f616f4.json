{"ast":null,"code":"var _jsxFileName = \"/Users/khoinguyen/Programming/delilah-ai/delilah-frontend/src/components/FreeWrite/index.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport ReactQuill, { Quill } from \"react-quill\";\nimport \"react-quill/dist/quill.snow.css\";\nimport Request from \"../Request\";\nimport sanitizeHtml from \"sanitize-html\";\nimport { useRef } from \"react\";\nimport { ArrowPathIcon } from \"@heroicons/react/24/outline\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FreeWrite = _ref => {\n  _s();\n  let {\n    freewriteThreads,\n    setFreewriteThreads,\n    selectedFreewriteThread\n  } = _ref;\n  const [text, setText] = useState(freewriteThreads.find(freewriteThread => freewriteThread.id === selectedFreewriteThread).text);\n  const quillRef = useRef(null);\n  const [bounds, setBounds] = useState(null);\n  const [showMenu, setShowMenu] = useState(false);\n  const [actionLoading, setActionLoading] = useState(false);\n  useEffect(() => {\n    setText(freewriteThreads.find(freewriteThread => freewriteThread.id === selectedFreewriteThread).text);\n  }, [selectedFreewriteThread]);\n  useEffect(() => {\n    const parameters = {\n      data: {\n        text: text\n      },\n      method: \"POST\"\n    };\n    const updateTextRequest = new Request(\"freewritethreads/\" + selectedFreewriteThread + \"/settext/\", parameters);\n    updateTextRequest.then(res => {\n      const newFreewriteThreads = freewriteThreads.map(freewriteThread => {\n        if (freewriteThread.id === selectedFreewriteThread) {\n          freewriteThread.text = text;\n        }\n        return freewriteThread;\n      });\n      setFreewriteThreads(newFreewriteThreads);\n    }).catch(err => {\n      console.log(err);\n    });\n  }, [text]);\n  const modules = {\n    toolbar: [[{\n      header: [1, 2, false]\n    }], [\"bold\", \"italic\", \"underline\", \"strike\", \"blockquote\"], [{\n      list: \"ordered\"\n    }, {\n      list: \"bullet\"\n    }, {\n      indent: \"-1\"\n    }, {\n      indent: \"+1\"\n    }], [\"link\", \"image\"]]\n  };\n  const handleChangeSelection = e => {\n    if (!e || e.length === 0) {\n      setShowMenu(false);\n      return;\n    }\n    const selectedText = window.getSelection().toString();\n    if (!selectedText) {\n      setShowMenu(false);\n      return;\n    }\n    const editor = quillRef.current.getEditor();\n    const selectionBounds = editor.getBounds(e.index, e.length);\n    setBounds(selectionBounds);\n    setShowMenu(true);\n  };\n  const makeFlowery = e => {\n    e.preventDefault();\n    const editor = quillRef.current.getEditor();\n    const selection = editor.getSelection(true);\n    const floweryRequest = new Request(\"freewritethreads/\" + selectedFreewriteThread + \"/createsnippet/\", {\n      data: {\n        input_text: window.getSelection().toString()\n      },\n      method: \"POST\"\n    });\n    floweryRequest.then(res => {\n      const floweryText = res.data.output_text;\n      editor.deleteText(selection.index, selection.length);\n      editor.insertText(selection.index, floweryText);\n      setShowMenu(false);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"freewrite flex flex-col h-screen grow p-10\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative\",\n      children: [/*#__PURE__*/_jsxDEV(ReactQuill, {\n        theme: \"snow\",\n        value: text,\n        onChange: setText,\n        modules: modules,\n        onChangeSelection: e => handleChangeSelection(e),\n        ref: quillRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"context-menu flex flex-col bg-[#FFFFFF]/90 rounded absolute space-x-1 text-white items-center\" + (showMenu ? \"\" : \" hidden\"),\n        style: bounds ? {\n          top: bounds.top,\n          left: bounds.left,\n          minWidth: 100,\n          maxWidth: 200\n        } : {},\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-1 text-xs bg-delilahPrimary font-medium rounded w-full hover:cursor-pointer z-40 flex flex-row\",\n          onMouseDown: e => makeFlowery(e),\n          children: [/*#__PURE__*/_jsxDEV(ArrowPathIcon, {\n            className: \"h-4 w-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"ml-2\",\n            children: \" Make flowery \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-1 text-xs bg-delilahPrimary font-medium rounded w-full hover:cursor-pointer z-40 flex flex-row\",\n          onMouseDown: e => makeFlowery(e),\n          children: \"Regenerate\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 119,\n    columnNumber: 3\n  }, this);\n};\n_s(FreeWrite, \"FDtiBx5k98cByHCz9/BElhy8sTA=\");\n_c = FreeWrite;\nexport default FreeWrite;\nvar _c;\n$RefreshReg$(_c, \"FreeWrite\");","map":{"version":3,"names":["React","useState","useEffect","ReactQuill","Quill","Request","sanitizeHtml","useRef","ArrowPathIcon","FreeWrite","freewriteThreads","setFreewriteThreads","selectedFreewriteThread","text","setText","find","freewriteThread","id","quillRef","bounds","setBounds","showMenu","setShowMenu","actionLoading","setActionLoading","parameters","data","method","updateTextRequest","then","res","newFreewriteThreads","map","catch","err","console","log","modules","toolbar","header","list","indent","handleChangeSelection","e","length","selectedText","window","getSelection","toString","editor","current","getEditor","selectionBounds","getBounds","index","makeFlowery","preventDefault","selection","floweryRequest","input_text","floweryText","output_text","deleteText","insertText","top","left","minWidth","maxWidth"],"sources":["/Users/khoinguyen/Programming/delilah-ai/delilah-frontend/src/components/FreeWrite/index.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\"\nimport ReactQuill, { Quill } from \"react-quill\"\nimport \"react-quill/dist/quill.snow.css\"\nimport Request from \"../Request\"\nimport sanitizeHtml from \"sanitize-html\"\nimport { useRef } from \"react\"\nimport { ArrowPathIcon } from \"@heroicons/react/24/outline\"\n\nconst FreeWrite = ({\n\tfreewriteThreads,\n\tsetFreewriteThreads,\n\tselectedFreewriteThread,\n}) => {\n\tconst [text, setText] = useState(\n\t\tfreewriteThreads.find(\n\t\t\t(freewriteThread) => freewriteThread.id === selectedFreewriteThread\n\t\t).text\n\t)\n\tconst quillRef = useRef(null)\n\tconst [bounds, setBounds] = useState(null)\n\tconst [showMenu, setShowMenu] = useState(false)\n\tconst [actionLoading, setActionLoading] = useState(false)\n\n\tuseEffect(() => {\n\t\tsetText(\n\t\t\tfreewriteThreads.find(\n\t\t\t\t(freewriteThread) => freewriteThread.id === selectedFreewriteThread\n\t\t\t).text\n\t\t)\n\t}, [selectedFreewriteThread])\n\n\tuseEffect(() => {\n\t\tconst parameters = {\n\t\t\tdata: {\n\t\t\t\ttext: text,\n\t\t\t},\n\t\t\tmethod: \"POST\",\n\t\t}\n\t\tconst updateTextRequest = new Request(\n\t\t\t\"freewritethreads/\" + selectedFreewriteThread + \"/settext/\",\n\t\t\tparameters\n\t\t)\n\n\t\tupdateTextRequest\n\t\t\t.then((res) => {\n\t\t\t\tconst newFreewriteThreads = freewriteThreads.map((freewriteThread) => {\n\t\t\t\t\tif (freewriteThread.id === selectedFreewriteThread) {\n\t\t\t\t\t\tfreewriteThread.text = text\n\t\t\t\t\t}\n\t\t\t\t\treturn freewriteThread\n\t\t\t\t})\n\t\t\t\tsetFreewriteThreads(newFreewriteThreads)\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\t}, [text])\n\n\tconst modules = {\n\t\ttoolbar: [\n\t\t\t[{ header: [1, 2, false] }],\n\t\t\t[\"bold\", \"italic\", \"underline\", \"strike\", \"blockquote\"],\n\t\t\t[\n\t\t\t\t{ list: \"ordered\" },\n\t\t\t\t{ list: \"bullet\" },\n\t\t\t\t{ indent: \"-1\" },\n\t\t\t\t{ indent: \"+1\" },\n\t\t\t],\n\t\t\t[\"link\", \"image\"],\n\t\t],\n\t}\n\n\tconst handleChangeSelection = (e) => {\n\t\tif (!e || e.length === 0) {\n\t\t\tsetShowMenu(false)\n\t\t\treturn\n\t\t}\n\n\t\tconst selectedText = window.getSelection().toString()\n\t\tif (!selectedText) {\n\t\t\tsetShowMenu(false)\n\t\t\treturn\n\t\t}\n\n\t\tconst editor = quillRef.current.getEditor()\n\t\tconst selectionBounds = editor.getBounds(e.index, e.length)\n\t\tsetBounds(selectionBounds)\n\t\tsetShowMenu(true)\n\t}\n\n\tconst makeFlowery = (e) => {\n\t\te.preventDefault()\n\t\tconst editor = quillRef.current.getEditor()\n\t\tconst selection = editor.getSelection(true)\n\n\t\tconst floweryRequest = new Request(\n\t\t\t\"freewritethreads/\" + selectedFreewriteThread + \"/createsnippet/\",\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tinput_text: window.getSelection().toString(),\n\t\t\t\t},\n\t\t\t\tmethod: \"POST\",\n\t\t\t}\n\t\t)\n\n\t\tfloweryRequest\n\t\t\t.then((res) => {\n\t\t\t\tconst floweryText = res.data.output_text\n\t\t\t\teditor.deleteText(selection.index, selection.length)\n\t\t\t\teditor.insertText(selection.index, floweryText)\n\t\t\t\tsetShowMenu(false)\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\t}\n\n\treturn (\n\t\t<div className='freewrite flex flex-col h-screen grow p-10'>\n\t\t\t<div className='relative'>\n\t\t\t\t<ReactQuill\n\t\t\t\t\ttheme='snow'\n\t\t\t\t\tvalue={text}\n\t\t\t\t\tonChange={setText}\n\t\t\t\t\tmodules={modules}\n\t\t\t\t\tonChangeSelection={(e) => handleChangeSelection(e)}\n\t\t\t\t\tref={quillRef}\n\t\t\t\t/>\n\n\t\t\t\t<div\n\t\t\t\t\tclassName={\n\t\t\t\t\t\t\"context-menu flex flex-col bg-[#FFFFFF]/90 rounded absolute space-x-1 text-white items-center\" +\n\t\t\t\t\t\t(showMenu ? \"\" : \" hidden\")\n\t\t\t\t\t}\n\t\t\t\t\tstyle={\n\t\t\t\t\t\tbounds\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\ttop: bounds.top,\n\t\t\t\t\t\t\t\t\tleft: bounds.left,\n\t\t\t\t\t\t\t\t\tminWidth: 100,\n\t\t\t\t\t\t\t\t\tmaxWidth: 200,\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t: {}\n\t\t\t\t\t}\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName='p-1 text-xs bg-delilahPrimary font-medium rounded w-full hover:cursor-pointer z-40 flex flex-row'\n\t\t\t\t\t\tonMouseDown={(e) => makeFlowery(e)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<ArrowPathIcon className='h-4 w-4' />\n\t\t\t\t\t\t<p className='ml-2'> Make flowery </p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName='p-1 text-xs bg-delilahPrimary font-medium rounded w-full hover:cursor-pointer z-40 flex flex-row'\n\t\t\t\t\t\tonMouseDown={(e) => makeFlowery(e)}\n\t\t\t\t\t>\n\t\t\t\t\t\tRegenerate\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default FreeWrite\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}