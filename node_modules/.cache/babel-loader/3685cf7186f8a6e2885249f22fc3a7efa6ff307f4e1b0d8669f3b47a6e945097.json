{"ast":null,"code":"var _jsxFileName = \"/Users/khoinguyen/Programming/penpal/src/components/Content.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport Spinner from \"./Spinner\";\nimport Request from \"./Request\";\nimport FreeWrite from \"./FreeWrite\";\nimport Cookies from \"universal-cookie\";\nimport { useAuth0 } from \"@auth0/auth0-react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst cookies = new Cookies();\nconst Content = () => {\n  _s();\n  const [threads, setThreads] = useState([]);\n  const [selectedThread, setSelectedThread] = useState(\"\");\n\n  // freewrite mode\n  const [freewriteThreads, setFreewriteThreads] = useState([]);\n  const [selectedFreewriteThread, setSelectedFreewriteThread] = useState(\"\");\n\n  // websocket connection\n  const [socket, setSocket] = useState(null);\n  const [reconnectSocket, setReconnectSocket] = useState(false);\n  useEffect(() => {\n    if (cookies.get(\"token\") === undefined) {\n      console.log(\"Cookies: \", cookies.getAll());\n      setTimeout(() => {}, 1000);\n    }\n    initData();\n    setSocket(new WebSocket(process.env.REACT_APP_WS_URL + \"ws/essay/\" + \"?token=\" + cookies.get(\"token\")));\n    setReconnectSocket(!reconnectSocket);\n  }, []);\n  useEffect(() => {\n    if (socket === null) return;\n    socket.onopen = e => {\n      console.log(\"Connected to websocket from home\");\n    };\n    socket.onclose = e => {\n      console.log(\"Disconnected from websocket from home because: \", e);\n      setTimeout(() => {\n        setSocket(connectToSocket());\n        setReconnectSocket(!reconnectSocket);\n      }, 1000);\n    };\n    socket.onerror = e => {\n      console.log(\"Error connecting to websocket from home\");\n      socket.close();\n    };\n    return () => {\n      socket.close();\n    };\n  }, [reconnectSocket]);\n  const connectToSocket = () => {\n    const newWS = new WebSocket(process.env.REACT_APP_WS_URL + \"ws/essay/\" + \"?token=\" + cookies.get(\"token\"));\n    return newWS;\n  };\n\n  // something random with initializing breaking the loading\n  const initData = () => {\n    // const threadsRequest = new Request(\"threads/\")\n    // threadsRequest\n    // \t.then((res) => {\n    // \t\tsetThreads(res.data)\n    // \t\tsetSelectedThread(res.data[0].id)\n    // \t})\n    // \t.catch((err) => {\n    // \t\tconsole.log(err)\n    // \t})\n    const freewriteThreadsRequest = new Request(\"freewritethreads/\");\n    freewriteThreadsRequest.then(res => {\n      setFreewriteThreads(res.data);\n      setSelectedFreewriteThread(res.data[0].id);\n    }).catch(err => {\n      console.log(err);\n    });\n\n    // const freewriteThreadsRequest = new Request(\"freewritethreads/\")\n    freewriteThreadsRequest.then(res => {\n      setFreewriteThreads(res.data);\n      setSelectedFreewriteThread(res.data[0].id);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n  if (selectedThread === \"\") {\n    return /*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 10\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-row from-green-200 to-green-500 bg-gradient-135\",\n    children: /*#__PURE__*/_jsxDEV(FreeWrite, {\n      freewriteThreads: freewriteThreads,\n      setFreewriteThreads: setFreewriteThreads,\n      selectedFreewriteThread: selectedFreewriteThread,\n      setSelectedFreewriteThread: setSelectedFreewriteThread,\n      socket: socket\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 3\n  }, this);\n};\n_s(Content, \"HiSalGNafIp71bAhYYOhmdAxiwo=\");\n_c = Content;\nexport default Content;\nvar _c;\n$RefreshReg$(_c, \"Content\");","map":{"version":3,"names":["React","useEffect","useState","Spinner","Request","FreeWrite","Cookies","useAuth0","cookies","Content","threads","setThreads","selectedThread","setSelectedThread","freewriteThreads","setFreewriteThreads","selectedFreewriteThread","setSelectedFreewriteThread","socket","setSocket","reconnectSocket","setReconnectSocket","get","undefined","console","log","getAll","setTimeout","initData","WebSocket","process","env","REACT_APP_WS_URL","onopen","e","onclose","connectToSocket","onerror","close","newWS","freewriteThreadsRequest","then","res","data","id","catch","err"],"sources":["/Users/khoinguyen/Programming/penpal/src/components/Content.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\"\nimport Spinner from \"./Spinner\"\nimport Request from \"./Request\"\nimport FreeWrite from \"./FreeWrite\"\nimport Cookies from \"universal-cookie\"\nimport { useAuth0 } from \"@auth0/auth0-react\"\n\nconst cookies = new Cookies()\n\nconst Content = () => {\n\tconst [threads, setThreads] = useState([])\n\tconst [selectedThread, setSelectedThread] = useState(\"\")\n\n\t// freewrite mode\n\tconst [freewriteThreads, setFreewriteThreads] = useState([])\n\tconst [selectedFreewriteThread, setSelectedFreewriteThread] = useState(\"\")\n\n\t// websocket connection\n\tconst [socket, setSocket] = useState(null)\n\tconst [reconnectSocket, setReconnectSocket] = useState(false)\n\n\tuseEffect(() => {\n\t\tif (cookies.get(\"token\") === undefined) {\n\t\t\tconsole.log(\"Cookies: \", cookies.getAll())\n\t\t\tsetTimeout(() => {}, 1000)\n\t\t}\n\n\t\tinitData()\n\n\t\tsetSocket(\n\t\t\tnew WebSocket(\n\t\t\t\tprocess.env.REACT_APP_WS_URL +\n\t\t\t\t\t\"ws/essay/\" +\n\t\t\t\t\t\"?token=\" +\n\t\t\t\t\tcookies.get(\"token\")\n\t\t\t)\n\t\t)\n\t\tsetReconnectSocket(!reconnectSocket)\n\t}, [])\n\n\tuseEffect(() => {\n\t\tif (socket === null) return\n\t\tsocket.onopen = (e) => {\n\t\t\tconsole.log(\"Connected to websocket from home\")\n\t\t}\n\n\t\tsocket.onclose = (e) => {\n\t\t\tconsole.log(\"Disconnected from websocket from home because: \", e)\n\t\t\tsetTimeout(() => {\n\t\t\t\tsetSocket(connectToSocket())\n\t\t\t\tsetReconnectSocket(!reconnectSocket)\n\t\t\t}, 1000)\n\t\t}\n\n\t\tsocket.onerror = (e) => {\n\t\t\tconsole.log(\"Error connecting to websocket from home\")\n\t\t\tsocket.close()\n\t\t}\n\n\t\treturn () => {\n\t\t\tsocket.close()\n\t\t}\n\t}, [reconnectSocket])\n\n\tconst connectToSocket = () => {\n\t\tconst newWS = new WebSocket(\n\t\t\tprocess.env.REACT_APP_WS_URL +\n\t\t\t\t\"ws/essay/\" +\n\t\t\t\t\"?token=\" +\n\t\t\t\tcookies.get(\"token\")\n\t\t)\n\t\treturn newWS\n\t}\n\n\t// something random with initializing breaking the loading\n\tconst initData = () => {\n\t\t// const threadsRequest = new Request(\"threads/\")\n\t\t// threadsRequest\n\t\t// \t.then((res) => {\n\t\t// \t\tsetThreads(res.data)\n\t\t// \t\tsetSelectedThread(res.data[0].id)\n\t\t// \t})\n\t\t// \t.catch((err) => {\n\t\t// \t\tconsole.log(err)\n\t\t// \t})\n\t\tconst freewriteThreadsRequest = new Request(\"freewritethreads/\")\n\t\tfreewriteThreadsRequest\n\t\t\t.then((res) => {\n\t\t\t\tsetFreewriteThreads(res.data)\n\t\t\t\tsetSelectedFreewriteThread(res.data[0].id)\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\n\t\t// const freewriteThreadsRequest = new Request(\"freewritethreads/\")\n\t\tfreewriteThreadsRequest\n\t\t\t.then((res) => {\n\t\t\t\tsetFreewriteThreads(res.data)\n\t\t\t\tsetSelectedFreewriteThread(res.data[0].id)\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\t}\n\n\tif (selectedThread === \"\") {\n\t\treturn <Spinner />\n\t}\n\n\treturn (\n\t\t<div className=\"flex flex-row from-green-200 to-green-500 bg-gradient-135\">\n\t\t\t<FreeWrite\n\t\t\t\tfreewriteThreads={freewriteThreads}\n\t\t\t\tsetFreewriteThreads={setFreewriteThreads}\n\t\t\t\tselectedFreewriteThread={selectedFreewriteThread}\n\t\t\t\tsetSelectedFreewriteThread={setSelectedFreewriteThread}\n\t\t\t\tsocket={socket}\n\t\t\t/>\n\t\t</div>\n\t)\n}\n\nexport default Content\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}